[{"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\index.js":"1","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\App.js":"2","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\reportWebVitals.js":"3","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\Firebase.js":"4","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatList.js":"5","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\FindNew.js":"6","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\Footer.js":"7","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\Profile.js":"8","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatRoom.js":"9","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignIn.js":"10","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignOut.js":"11","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatMessage.js":"12","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignUp.js":"13","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatPerson.js":"14","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatRoom2.js":"15"},{"size":517,"mtime":1611630800090,"results":"16","hashOfConfig":"17"},{"size":2781,"mtime":1613268571678,"results":"18","hashOfConfig":"17"},{"size":375,"mtime":1610944178226,"results":"19","hashOfConfig":"17"},{"size":995,"mtime":1611786522784,"results":"20","hashOfConfig":"17"},{"size":1701,"mtime":1613272318159,"results":"21","hashOfConfig":"17"},{"size":2612,"mtime":1611904446288,"results":"22","hashOfConfig":"17"},{"size":707,"mtime":1611447821479,"results":"23","hashOfConfig":"17"},{"size":2770,"mtime":1611796464392,"results":"24","hashOfConfig":"17"},{"size":1661,"mtime":1613270743041,"results":"25","hashOfConfig":"17"},{"size":2084,"mtime":1611100356274,"results":"26","hashOfConfig":"17"},{"size":275,"mtime":1611910997379,"results":"27","hashOfConfig":"17"},{"size":939,"mtime":1613269276679,"results":"28","hashOfConfig":"17"},{"size":4376,"mtime":1611023489907,"results":"29","hashOfConfig":"17"},{"size":1957,"mtime":1611172748022,"results":"30","hashOfConfig":"17"},{"size":2706,"mtime":1613268630363,"results":"31","hashOfConfig":"17"},{"filePath":"32","messages":"33","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},"1hyjv0o",{"filePath":"35","messages":"36","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"37","usedDeprecatedRules":"34"},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"44","messages":"45","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"46","usedDeprecatedRules":"34"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"49","messages":"50","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"51","usedDeprecatedRules":"34"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"54","messages":"55","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"56","usedDeprecatedRules":"34"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"59","usedDeprecatedRules":"34"},{"filePath":"60","messages":"61","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"62","messages":"63","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"64","usedDeprecatedRules":"34"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"69","usedDeprecatedRules":"34"},"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\index.js",[],["70","71"],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\App.js",["72","73","74","75","76"],"import React, { useRef, useState } from 'react';\r\nimport './App.css';\r\nimport {\r\n  BrowserRouter,\r\n  Switch,\r\n  Route,\r\n  Link\r\n} from \"react-router-dom\";\r\n\r\n//import './App.css';\r\n\r\nimport firebase, { firestore, auth } from './Firebase.js';\r\nimport { useAuthState } from 'react-firebase-hooks/auth';\r\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\r\n\r\nimport ChatList from './components/ChatList.js';\r\nimport FindNew from './components/FindNew.js';\r\nimport Footer from './components/Footer.js';\r\nimport Profile from './components/Profile.js';\r\nimport ChatRoom2 from './components/ChatRoom2.js';\r\nimport SignOut from './components/SignOut.js';\r\nimport SignIn from './components/SignIn.js';\r\nimport SignUp from './components/SignUp.js';\r\nimport ChatRoom from './components/ChatRoom.js';\r\n\r\nfunction App() {\r\n  console.log('App rendered');\r\n  const [user] = useAuthState(auth);\r\n  const [roomNum, setRoomNum] = useState(\" \");\r\n  const callbackFunction = (childData) => {\r\n    setRoomNum(childData);\r\n    console.log(\"APP:\" + roomNum);\r\n  };\r\n  // const [roomNum, setRoomNum] = useState([]);\r\n\r\n  // const callbackFunction = (childData) => {\r\n  //     setRoomNum(childData);\r\n  // };\r\n  return (\r\n    <div className=\"App\">\r\n      <header>\r\n        <h1>⚛️🔥💬</h1>\r\n        <SignOut parentCallback={callbackFunction}/>\r\n      </header>\r\n\r\n      {/* <section>\r\n        {user ? <ChatRoom /> : <SignIn />}\r\n      </section> */}\r\n\r\n      <BrowserRouter className=\"navbar navbar-default\">\r\n        <Footer className= \"\"/>\r\n        <Switch>\r\n          <Route path=\"/profile\">\r\n            <Profile />\r\n          </Route>\r\n          <Route path=\"/new\">\r\n            <FindNew />\r\n          </Route>\r\n          {/* <Route path=\"/room\">\r\n            {user ? <ChatRoom /> : <SignIn auth={auth}/>}\r\n          </Route> */}\r\n          <Route path=\"/signup\">\r\n            {() => {\r\n              if (!user) {\r\n                return <SignUp />;\r\n              } else {\r\n                return null;\r\n              }\r\n            }}\r\n          </Route>\r\n          {/* {directRooms.map(channelid => <Route path={\"direct/\"+channelid}>\r\n            {user ? <div><ChatList parentCallback={callbackFunction}/> <ChatRoom2 channelid={channelid.channelID}/></div>  : <SignIn/>}\r\n          </Route>)} */}\r\n          <Route path=\"/direct\">\r\n            {user ?\r\n              <div>\r\n                <ChatList parentCallback={callbackFunction}/>\r\n                {roomNum===\" \" ? <h1>No Room yet</h1> : <ChatRoom2 channelid={roomNum}/>}\r\n              </div> : <SignIn />}\r\n          </Route>\r\n          <Route path=\"/\">\r\n            {user ? <ChatRoom /> : <SignIn />}\r\n          </Route>\r\n\r\n        </Switch>\r\n\r\n      </BrowserRouter>\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\reportWebVitals.js",[],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\Firebase.js",[],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatList.js",["77","78","79","80","81","82","83","84","85","86","87","88","89","90"],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\FindNew.js",["91","92"],"import React, { useState, useEffect } from 'react'\r\nimport firebase, { firestore, auth } from '../Firebase.js';\r\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\r\n\r\n\r\nconst FindNew = () => {\r\n    //firestore.collection('users')\r\n    const [foundUser, setFoundUser] = useState('no one');\r\n    const [userCount, setUserCount] = useState(0);\r\n    // const [existed, setExisted] = useState([]);\r\n    // if(auth.currentUser){\r\n    //     const currentUser = firestore.collection('users').doc(auth.currentUser.uid);\r\n    //     const strangerList = currentUser.collection('strangers');\r\n    //     currentUser.get().then(function (doc) {\r\n    //         const currentUserIndex = doc.data().userCount;\r\n    //         if(!existed.includes(currentUserIndex)){\r\n    //             setExisted(existed.push(currentUserIndex));\r\n    //         }\r\n    //     });\r\n    // }\r\n\r\n\r\n    const onClick = () => {\r\n        setFoundUser(\"Matching\");\r\n        const ref = firestore.collection('info').doc('userCount');\r\n        ref.get().then(function (doc) {\r\n            setUserCount(doc.data().userCount);\r\n        });\r\n        console.log(\"userCount \"+ userCount);\r\n        var randomIndex = Math.floor(Math.random() * userCount) + 1;  // returns a random integer from 1 to userCount\r\n        console.log(\"random: \"+ randomIndex);\r\n        const messagesRef = firestore.collection('users');\r\n        var query = messagesRef.where(\"userCount\", \"==\", randomIndex);\r\n        query.get().then(function (querySnapshot) {\r\n            querySnapshot.forEach(function (doc) {\r\n                var users = doc;\r\n                \r\n                setFoundUser(users.data().name);\r\n                var initConversation = firebase.functions().httpsCallable('initConversation');\r\n                initConversation({ uidA: auth.currentUser.uid, uidB: users.id });\r\n            });\r\n        });\r\n        // combinedID = uidA > uidB ? uidB+uidA : uidA+uidB\r\n        // firestore.collection('messages').doc(combinedID).collection('chats').add({\r\n        //     text: \"hi\",\r\n        //     createdAt: firebase.firestore.FieldValue.serverTimestamp(),\r\n        //     uid: auth.currentUser.uid,\r\n        //     url: \"auth.currentUser.uid\"\r\n        // });\r\n\r\n        // firestore.collection('users').doc(combinedID).collection('strangers').add({\r\n        //     channelID: combinedID\r\n        // });\r\n    }\r\n    return auth.currentUser && (\r\n        <div>\r\n            <button onClick={onClick}>Find a random person to chat with!</button>\r\n            <h1>Found: {foundUser}</h1>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FindNew;","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\Footer.js",[],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\Profile.js",["93","94","95","96","97"],"import { user } from 'firebase-functions/lib/providers/auth';\r\nimport React, { useState, useEffect } from 'react'\r\nimport firebase, { firestore, auth, storage } from '../Firebase.js';\r\n\r\nconst Profile = () => {\r\n\r\n    const [userName, setUserName] = useState(\"\");\r\n    const [userInfo, setUserInfo] = useState(\"\");\r\n    const [userPhotoURL, setUserPhotoURL] = useState(\"\");\r\n\r\n\r\n    // if(auth.currentUser){\r\n    //     firestore.collection('users').doc(auth.currentUser.uid).get().then(function(doc){\r\n    //         //setUserInfo(doc.get(\"info\"));\r\n    //     }).catch(function(err){\r\n    //         console.log(\"Error getting document:\", err);\r\n    //     });\r\n    //     //setUserName(auth.currentUser.displayName);\r\n    //     //setUserName(auth.currentUser.photoURL);\r\n    // }\r\n\r\n\r\n\r\n\r\n    const onNameUpdate = () => {\r\n        auth.currentUser.updateProfile({\r\n            displayName: userName,\r\n        });\r\n        firestore.collection('users').doc(auth.currentUser.uid).set({\r\n            name: userName,\r\n        }, {merge : true});\r\n    }\r\n    const onPhotoUpdate = () => {\r\n        auth.currentUser.updateProfile({\r\n            photoURL: userPhotoURL,\r\n        });\r\n        firestore.collection('users').doc(auth.currentUser.uid).set({\r\n            photoURL: userPhotoURL,\r\n        }, {merge : true});\r\n    }\r\n    const onInfoUpdate = () => {\r\n        auth.currentUser.updateProfile({\r\n            info: userInfo,\r\n        });\r\n        firestore.collection('users').doc(auth.currentUser.uid).set({\r\n            info: userInfo\r\n        } , {merge : true});\r\n    }\r\n    return auth.currentUser && (\r\n        <div>\r\n            <h1>Name: {auth.currentUser.displayName}</h1>\r\n            <form onSubmit={() => onNameUpdate()}>\r\n                <input type=\"text\" value={userName} onChange={(event) => { setUserName(event.target.value) }} />\r\n                <button type=\"submit\">Save Display Name</button>\r\n            </form>\r\n            <br />\r\n            <p>Email: {auth.currentUser.email}</p>\r\n            <br />\r\n            <img src={auth.currentUser.photoURL} alt=\"User's profile picture\" />\r\n            <br />\r\n            <form onSubmit={() => onPhotoUpdate()}>\r\n                <input type=\"text\" value={userPhotoURL} onChange={(event) => { setUserPhotoURL(event.target.value)}}/>\r\n                <button type=\"submit\">Upload Profile Picture</button>\r\n            </form>\r\n\r\n            <br />\r\n\r\n            <p>Info: {auth.currentUser.info}</p>\r\n            <form onSubmit={() => onInfoUpdate()}>\r\n                <input type=\"text\" value={userInfo} onChange={(event) => { setUserInfo(event.target.value) }} />\r\n                <button type=\"submit\">Edit Bio</button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Profile;","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatRoom.js",["98"],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignIn.js",["99","100"],"import React, { useState } from 'react';\r\nimport firebase, {firestore, auth} from '../Firebase.js';\r\nimport 'firebase/auth';\r\n\r\nfunction SignIn() {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState(null);\r\n  \r\n  const onChangeHandler = (event) => {\r\n    const { name, value } = event.currentTarget;\r\n\r\n    if (name === 'userEmail') {\r\n      setEmail(value);\r\n    }\r\n    else if (name === 'userPassword') {\r\n      setPassword(value);\r\n    }\r\n  };\r\n\r\n\r\n  const signInWithGoogle = () => {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    auth.signInWithPopup(provider);\r\n  };\r\n\r\n\r\n  const signInWithEmailAndPasswordHandler = (event, email, password) => {\r\n    event.preventDefault();\r\n    auth.signInWithEmailAndPassword(email, password).catch(error => {\r\n      setError(\"Error signing in with password and email!\");\r\n      console.error(\"Error signing in with password and email\", error);\r\n    });\r\n  };\r\n\r\n\r\n  return (\r\n    <div>\r\n    <form className=\"\">\r\n      <label htmlFor=\"userEmail\" className=\"block\">\r\n        Email:\r\n        </label>\r\n      <input\r\n        type=\"email\"\r\n        className=\"my-1 p-1 w-full\"\r\n        name=\"userEmail\"\r\n        value={email}\r\n        placeholder=\"E.g: faruq123@gmail.com\"\r\n        id=\"userEmail\"\r\n        onChange={(event) => onChangeHandler(event)}\r\n      />\r\n      <label htmlFor=\"userPassword\" className=\"block\">\r\n        Password:\r\n        </label>\r\n      <input\r\n        type=\"password\"\r\n        className=\"mt-1 mb-3 p-1 w-full\"\r\n        name=\"userPassword\"\r\n        value={password}\r\n        placeholder=\"Your Password\"\r\n        id=\"userPassword\"\r\n        onChange={(event) => onChangeHandler(event)}\r\n      />\r\n      <button className=\"bg-green-400 hover:bg-green-500 w-full py-2 text-white\" onClick={(event) => { signInWithEmailAndPasswordHandler(event, email, password) }}>\r\n        Sign in\r\n        </button>\r\n    </form>\r\n\r\n    <button onClick={signInWithGoogle}>Sign in with Google</button>\r\n  </div>\r\n  );\r\n};\r\n\r\nexport default SignIn;","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignOut.js",["101","102"],"import React from 'react';\r\n\r\nimport firebase, {firestore, auth} from '../Firebase.js';\r\n\r\nfunction SignOut(props) {\r\n  return auth.currentUser && (\r\n    <button onClick={() => {props.parentCallback(\" \"); auth.signOut()}}>Sign Out</button>\r\n  )\r\n};\r\n\r\nexport default SignOut;","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatMessage.js",["103","104","105"],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\SignUp.js",["106"],"import React, { useState } from \"react\";\r\nimport {\r\n    Link\r\n} from \"react-router-dom\";\r\nimport firebase from '../Firebase.js';\r\n\r\n\r\nconst auth = firebase.auth();\r\nfirebase.auth().useEmulator('http://localhost:9099/');\r\n\r\nconst SignUp = () => {\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [displayName, setDisplayName] = useState(\"\");\r\n    const [error, setError] = useState(null);\r\n\r\n    const createUserWithEmailAndPasswordHandler = (event, email, password, name) => {\r\n        event.preventDefault();\r\n        auth.createUserWithEmailAndPassword(email, password);\r\n        \r\n        // .then((user)=>{\r\n        //     if(user){\r\n        //         user.updateProfile({\r\n        //             displayName: \"Jane Q. User\",\r\n        //             photoURL: \"https://example.com/jane-q-user/profile.jpg\"\r\n        //         })\r\n        //     }}\r\n        // )\r\n        setEmail(\"\");\r\n        setPassword(\"\");\r\n        setDisplayName(\"\");\r\n    };\r\n\r\n    const onChangeHandler = event => {\r\n        const { name, value } = event.currentTarget;\r\n        if (name === \"userEmail\") {\r\n            setEmail(value);\r\n        } else if (name === \"userPassword\") {\r\n            setPassword(value);\r\n        } else if (name === \"displayName\") {\r\n            setDisplayName(value);\r\n        }\r\n    };\r\n    return (\r\n        <div className=\"mt-8\">\r\n            <h1 className=\"text-3xl mb-2 text-center font-bold\">Sign Up</h1>\r\n            <div className=\"border border-blue-400 mx-auto w-11/12 md:w-2/4 rounded py-8 px-4 md:px-8\">\r\n                {error !== null && (\r\n                    <div className=\"py-4 bg-red-600 w-full text-white text-center mb-3\">\r\n                        {error}\r\n                    </div>\r\n                )}\r\n                <form className=\"\">\r\n                    <label htmlFor=\"displayName\" className=\"block\">\r\n                        Display Name:\r\n          </label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"my-1 p-1 w-full \"\r\n                        name=\"displayName\"\r\n                        value={displayName}\r\n                        placeholder=\"E.g: Faruq\"\r\n                        id=\"displayName\"\r\n                        onChange={event => onChangeHandler(event)}\r\n                    />\r\n                    <label htmlFor=\"userEmail\" className=\"block\">\r\n                        Email:\r\n          </label>\r\n                    <input\r\n                        type=\"email\"\r\n                        className=\"my-1 p-1 w-full\"\r\n                        name=\"userEmail\"\r\n                        value={email}\r\n                        placeholder=\"E.g: faruq123@gmail.com\"\r\n                        id=\"userEmail\"\r\n                        onChange={event => onChangeHandler(event)}\r\n                    />\r\n                    <label htmlFor=\"userPassword\" className=\"block\">\r\n                        Password:\r\n          </label>\r\n                    <input\r\n                        type=\"password\"\r\n                        className=\"mt-1 mb-3 p-1 w-full\"\r\n                        name=\"userPassword\"\r\n                        value={password}\r\n                        placeholder=\"Your Password\"\r\n                        id=\"userPassword\"\r\n                        onChange={event => onChangeHandler(event)}\r\n                    />\r\n                    <button\r\n                        className=\"bg-green-400 hover:bg-green-500 w-full py-2 text-white\"\r\n                        onClick={event => {\r\n                            createUserWithEmailAndPasswordHandler(event, email, password,displayName)\r\n                        }}\r\n                    >\r\n                        Sign up\r\n          </button>\r\n                </form>\r\n                <p className=\"text-center my-3\">or</p>\r\n                <button\r\n                    className=\"bg-red-500 hover:bg-red-600 w-full py-2 text-white\"\r\n                >\r\n                    Sign In with Google\r\n        </button>\r\n                <p className=\"text-center my-3\">\r\n                    Already have an account?{\" \"}\r\n                    <Link to=\"/\" className=\"text-blue-500 hover:text-blue-600\">\r\n                        Sign in here\r\n                    </Link>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default SignUp;","C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatPerson.js",[],"C:\\Users\\Jimmy\\ReactProjects\\chatapp_versions\\chatapp_cloud_functions\\src\\components\\ChatRoom2.js",["107","108","109","110","111","112","113","114","115"],"import React, { useMemo, useRef, useState } from 'react';\r\nimport { withRouter } from 'react-router';\r\nimport { useCollectionData, useDocument, useDocumentData } from 'react-firebase-hooks/firestore';\r\nimport firebase, { firestore, auth } from '../Firebase.js';\r\nimport ChatMessage from './ChatMessage';\r\nimport { _onRequestWithOptions } from 'firebase-functions/lib/providers/https';\r\n\r\n\r\nconst ChatRoom2 = (props) => {\r\n    var encrypt = firebase.functions().httpsCallable('encrypt');\r\n    console.log(\"chat room rendered\");\r\n\r\n    var encrypt = firebase.functions().httpsCallable('encrypt');\r\n    var decrypt = firebase.functions().httpsCallable('decrypt');\r\n\r\n    function saveQuery() {\r\n        const channelid = props.channelid;\r\n        const messagesRef = firestore.collection('messages').doc(channelid).collection('chats');\r\n        const query = messagesRef.orderBy('createdAt').limitToLast(25);\r\n        return [messagesRef, query];\r\n    }\r\n\r\n    const [messagesRef, query] = useMemo(() => saveQuery(), [props.channelid]);\r\n    const [messages] = useCollectionData(query, { idField: 'id' });\r\n    const [formValue, setFormValue] = useState('');\r\n    const [quit, setQuit] = useState('');\r\n    //const [value, loading, error] = useDocument(firestore.collection('messages').doc(props.channelid));\r\n    //const profile = value.data().profile;\r\n    //const [profile, showProfile] = useState(\"\");\r\n\r\n    const sendMessage = async (e) => {\r\n        e.preventDefault();\r\n\r\n        console.log(messagesRef);\r\n        console.log(query);\r\n        console.log(messages);\r\n\r\n        const { uid, photoURL } = auth.currentUser;\r\n\r\n        await messagesRef.add({\r\n            text: (await encrypt({ msg: formValue })).data.ciphertext,\r\n            createdAt: firebase.firestore.FieldValue.serverTimestamp(),\r\n            uid,\r\n            photoURL\r\n        })\r\n\r\n        setFormValue('');\r\n    }\r\n\r\n    const onQuit = () => {\r\n        setQuit('quit');\r\n    }\r\n    const onProfileRequest = () => {\r\n        firestore.collection('messages').doc(props.channelid).set({\r\n            profile: \"yes\",\r\n        })\r\n    }\r\n    return quit != 'quit' && (<>\r\n        <main>\r\n            {messages && messages.map(msg => <ChatMessage key={msg.id} message={msg} />)}\r\n        </main>\r\n\r\n        <form onSubmit={sendMessage}>\r\n\r\n            <input value={formValue} onChange={(e) => setFormValue(e.target.value)} placeholder=\"say something nice\" />\r\n\r\n            <button type=\"submit\" disabled={!formValue}>🕊️</button>\r\n\r\n        </form>\r\n\r\n\r\n        <button onClick={()=>onQuit()}>Quit</button>\r\n        <button onClick={()=>onProfileRequest()}>Request Profile</button>\r\n    </>)\r\n}\r\n\r\n\r\nexport default ChatRoom2;",{"ruleId":"116","replacedBy":"117"},{"ruleId":"118","replacedBy":"119"},{"ruleId":"120","severity":1,"message":"121","line":1,"column":17,"nodeType":"122","messageId":"123","endLine":1,"endColumn":23},{"ruleId":"120","severity":1,"message":"124","line":7,"column":3,"nodeType":"122","messageId":"123","endLine":7,"endColumn":7},{"ruleId":"120","severity":1,"message":"125","line":12,"column":8,"nodeType":"122","messageId":"123","endLine":12,"endColumn":16},{"ruleId":"120","severity":1,"message":"126","line":12,"column":20,"nodeType":"122","messageId":"123","endLine":12,"endColumn":29},{"ruleId":"120","severity":1,"message":"127","line":14,"column":10,"nodeType":"122","messageId":"123","endLine":14,"endColumn":27},{"ruleId":"120","severity":1,"message":"128","line":1,"column":17,"nodeType":"122","messageId":"123","endLine":1,"endColumn":27},{"ruleId":"120","severity":1,"message":"129","line":1,"column":29,"nodeType":"122","messageId":"123","endLine":1,"endColumn":37},{"ruleId":"120","severity":1,"message":"130","line":1,"column":39,"nodeType":"122","messageId":"123","endLine":1,"endColumn":48},{"ruleId":"120","severity":1,"message":"131","line":4,"column":22,"nodeType":"122","messageId":"123","endLine":4,"endColumn":28},{"ruleId":"120","severity":1,"message":"132","line":5,"column":5,"nodeType":"122","messageId":"123","endLine":5,"endColumn":11},{"ruleId":"120","severity":1,"message":"133","line":6,"column":5,"nodeType":"122","messageId":"123","endLine":6,"endColumn":10},{"ruleId":"120","severity":1,"message":"124","line":7,"column":5,"nodeType":"122","messageId":"123","endLine":7,"endColumn":9},{"ruleId":"120","severity":1,"message":"134","line":8,"column":5,"nodeType":"122","messageId":"123","endLine":8,"endColumn":14},{"ruleId":"120","severity":1,"message":"135","line":9,"column":5,"nodeType":"122","messageId":"123","endLine":9,"endColumn":18},{"ruleId":"120","severity":1,"message":"125","line":12,"column":8,"nodeType":"122","messageId":"123","endLine":12,"endColumn":16},{"ruleId":"120","severity":1,"message":"136","line":14,"column":8,"nodeType":"122","messageId":"123","endLine":14,"endColumn":18},{"ruleId":"120","severity":1,"message":"137","line":15,"column":8,"nodeType":"122","messageId":"123","endLine":15,"endColumn":17},{"ruleId":"138","severity":1,"message":"139","line":42,"column":21,"nodeType":"140","endLine":42,"endColumn":106},{"ruleId":"141","severity":1,"message":"142","line":50,"column":1,"nodeType":"143","messageId":"144","endLine":52,"endColumn":32},{"ruleId":"120","severity":1,"message":"130","line":1,"column":27,"nodeType":"122","messageId":"123","endLine":1,"endColumn":36},{"ruleId":"120","severity":1,"message":"127","line":3,"column":10,"nodeType":"122","messageId":"123","endLine":3,"endColumn":27},{"ruleId":"120","severity":1,"message":"145","line":1,"column":10,"nodeType":"122","messageId":"123","endLine":1,"endColumn":14},{"ruleId":"120","severity":1,"message":"130","line":2,"column":27,"nodeType":"122","messageId":"123","endLine":2,"endColumn":36},{"ruleId":"120","severity":1,"message":"125","line":3,"column":8,"nodeType":"122","messageId":"123","endLine":3,"endColumn":16},{"ruleId":"120","severity":1,"message":"146","line":3,"column":37,"nodeType":"122","messageId":"123","endLine":3,"endColumn":44},{"ruleId":"147","severity":1,"message":"148","line":59,"column":13,"nodeType":"140","endLine":59,"endColumn":81},{"ruleId":"120","severity":1,"message":"121","line":1,"column":18,"nodeType":"122","messageId":"123","endLine":1,"endColumn":24},{"ruleId":"120","severity":1,"message":"126","line":2,"column":19,"nodeType":"122","messageId":"123","endLine":2,"endColumn":28},{"ruleId":"120","severity":1,"message":"149","line":8,"column":10,"nodeType":"122","messageId":"123","endLine":8,"endColumn":15},{"ruleId":"120","severity":1,"message":"125","line":3,"column":8,"nodeType":"122","messageId":"123","endLine":3,"endColumn":16},{"ruleId":"120","severity":1,"message":"126","line":3,"column":19,"nodeType":"122","messageId":"123","endLine":3,"endColumn":28},{"ruleId":"120","severity":1,"message":"121","line":1,"column":18,"nodeType":"122","messageId":"123","endLine":1,"endColumn":24},{"ruleId":"120","severity":1,"message":"126","line":2,"column":19,"nodeType":"122","messageId":"123","endLine":2,"endColumn":28},{"ruleId":"150","severity":1,"message":"151","line":22,"column":7,"nodeType":"140","endLine":22,"endColumn":29},{"ruleId":"120","severity":1,"message":"152","line":15,"column":19,"nodeType":"122","messageId":"123","endLine":15,"endColumn":27},{"ruleId":"120","severity":1,"message":"121","line":1,"column":26,"nodeType":"122","messageId":"123","endLine":1,"endColumn":32},{"ruleId":"120","severity":1,"message":"128","line":2,"column":10,"nodeType":"122","messageId":"123","endLine":2,"endColumn":20},{"ruleId":"120","severity":1,"message":"153","line":3,"column":29,"nodeType":"122","messageId":"123","endLine":3,"endColumn":40},{"ruleId":"120","severity":1,"message":"154","line":3,"column":42,"nodeType":"122","messageId":"123","endLine":3,"endColumn":57},{"ruleId":"120","severity":1,"message":"155","line":6,"column":10,"nodeType":"122","messageId":"123","endLine":6,"endColumn":31},{"ruleId":"156","severity":1,"message":"157","line":13,"column":9,"nodeType":"122","messageId":"158","endLine":13,"endColumn":16},{"ruleId":"120","severity":1,"message":"159","line":14,"column":9,"nodeType":"122","messageId":"123","endLine":14,"endColumn":16},{"ruleId":"160","severity":1,"message":"161","line":23,"column":61,"nodeType":"162","endLine":23,"endColumn":78,"suggestions":"163"},{"ruleId":"164","severity":1,"message":"165","line":58,"column":17,"nodeType":"166","messageId":"167","endLine":58,"endColumn":19},"no-native-reassign",["168"],"no-negated-in-lhs",["169"],"no-unused-vars","'useRef' is defined but never used.","Identifier","unusedVar","'Link' is defined but never used.","'firebase' is defined but never used.","'firestore' is defined but never used.","'useCollectionData' is defined but never used.","'withRouter' is defined but never used.","'useState' is defined but never used.","'useEffect' is defined but never used.","'Router' is defined but never used.","'Switch' is defined but never used.","'Route' is defined but never used.","'useParams' is defined but never used.","'useRouteMatch' is defined but never used.","'ChatPerson' is defined but never used.","'ChatRoom2' is defined but never used.","jsx-a11y/anchor-is-valid","The href attribute is required for an anchor to be keyboard accessible. Provide a valid, navigable address as the href value. If you cannot provide an href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/anchor-is-valid.md","JSXOpeningElement","no-lone-blocks","Block is redundant.","BlockStatement","redundantBlock","'user' is defined but never used.","'storage' is defined but never used.","jsx-a11y/img-redundant-alt","Redundant alt attribute. Screen-readers already announce `img` tags as an image. You don’t need to use the words `image`, `photo,` or `picture` (or any specified custom words) in the alt prop.","'error' is assigned a value but never used.","jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","'setError' is assigned a value but never used.","'useDocument' is defined but never used.","'useDocumentData' is defined but never used.","'_onRequestWithOptions' is defined but never used.","no-redeclare","'encrypt' is already defined.","redeclared","'decrypt' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useMemo has a missing dependency: 'saveQuery'. Either include it or remove the dependency array.","ArrayExpression",["170"],"eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","no-global-assign","no-unsafe-negation",{"desc":"171","fix":"172"},"Update the dependencies array to be: [saveQuery]",{"range":"173","text":"174"},[1014,1031],"[saveQuery]"]